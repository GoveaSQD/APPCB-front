<div class="flex align-items-center justify-content-center min-h-screen register-bg">
  <p-toast position="top-right"></p-toast>
  <div class="register-card">
    
    <div class="logo-register"></div>

    <h1 class="text-3xl font-bold text-900 mb-2 text-center" style="color: #1f3d66;">Crear cuenta</h1>
    <p class="text-500 text-lg text-center mb-5">Sistema de Gestión de Becas</p>

    <form [formGroup]="registerForm" (ngSubmit)="onSubmit()" class="flex flex-column gap-4">
      
      <!-- Fila 1: Nombre y Apellido Paterno -->
      <div class="grid">
        <div class="col-12 md:col-6">
          <div class="flex flex-column gap-2">
            <label for="nombre" class="text-sm font-medium text-700">Nombre(s)</label>
            <p-inputgroup>
              <p-inputgroup-addon>
                <i class="pi pi-user"></i>
              </p-inputgroup-addon>
              <input 
                pInputText 
                id="nombre"
                type="text"
                formControlName="nombre"
                placeholder="Ej. Juan Carlos"
                class="w-full"
                [class.ng-invalid]="submitted && f['nombre'].errors">
            </p-inputgroup>
            @if (submitted && f['nombre'].errors) {
              <small class="p-error">
                {{ f['nombre'].errors['required'] ? 'Requerido' : 'Mínimo 3 caracteres' }}
              </small>
            }
          </div>
        </div>

        <div class="col-12 md:col-6">
          <div class="flex flex-column gap-2">
            <label for="ap_paterno" class="text-sm font-medium text-700">Apellido paterno</label>
            <p-inputgroup>
              <p-inputgroup-addon>
                <i class="pi pi-user"></i>
              </p-inputgroup-addon>
              <input 
                pInputText 
                id="ap_paterno"
                type="text"
                formControlName="ap_paterno"
                placeholder="Ej. Pérez"
                class="w-full"
                [class.ng-invalid]="submitted && f['ap_paterno'].errors">
            </p-inputgroup>
            @if (submitted && f['ap_paterno'].errors) {
              <small class="p-error">
                {{ f['ap_paterno'].errors['required'] ? 'Requerido' : 'Mínimo 2 caracteres' }}
              </small>
            }
          </div>
        </div>
      </div>

      <!-- Fila 2: Apellido Materno y Teléfono -->
      <div class="grid">
        <div class="col-12 md:col-6">
          <div class="flex flex-column gap-2">
            <label for="ap_materno" class="text-sm font-medium text-700">Apellido materno</label>
            <p-inputgroup>
              <p-inputgroup-addon>
                <i class="pi pi-user"></i>
              </p-inputgroup-addon>
              <input 
                pInputText 
                id="ap_materno"
                type="text"
                formControlName="ap_materno"
                placeholder="Ej. García (opcional)"
                class="w-full">
            </p-inputgroup>
          </div>
        </div>

        <div class="col-12 md:col-6">
          <div class="flex flex-column gap-2">
            <label for="telefono" class="text-sm font-medium text-700">Teléfono</label>
            <p-inputgroup>
              <p-inputgroup-addon>
                <i class="pi pi-phone"></i>
              </p-inputgroup-addon>
              <input 
                pInputText 
                id="telefono"
                type="tel"
                formControlName="telefono"
                placeholder="5512345678"
                class="w-full"
                [class.ng-invalid]="submitted && f['telefono'].errors">
            </p-inputgroup>
            @if (submitted && f['telefono'].errors) {
              <small class="p-error">
                10 dígitos
              </small>
            }
          </div>
        </div>
      </div>

      <!-- Fila 3: Email -->
      <div class="grid">
        <div class="col-12">
          <div class="flex flex-column gap-2">
            <label for="email" class="text-sm font-medium text-700">Correo electrónico</label>
            <p-inputgroup>
              <p-inputgroup-addon>
                <i class="pi pi-envelope"></i>
              </p-inputgroup-addon>
              <input 
                pInputText 
                id="email"
                type="email"
                formControlName="email"
                placeholder="correo@ejemplo.com"
                autocomplete="off"
                class="w-full"
                [class.ng-invalid]="submitted && f['email'].errors">
            </p-inputgroup>
            @if (submitted && f['email'].errors) {
              <small class="p-error">
                {{ f['email'].errors['required'] ? 'Requerido' : 'Correo inválido' }}
              </small>
            }
          </div>
        </div>
      </div>

      <!-- Fila 4: Contraseña y Confirmación -->
      <div class="grid">
        <div class="col-12 md:col-6">
          <div class="flex flex-column gap-2">
            <label for="password" class="text-sm font-medium text-700">Contraseña</label>
            <p-inputgroup>
              <p-inputgroup-addon>
                <i class="pi pi-lock"></i>
              </p-inputgroup-addon>
              <p-password 
                id="password"
                formControlName="password"
                [feedback]="true"
                [toggleMask]="true"
                [style]="{'width': '100%'}"
                inputStyleClass="w-full"
                [promptLabel]="'Ingresa una contraseña'"
                [weakLabel]="'Débil'"
                [mediumLabel]="'Media'"
                [strongLabel]="'Fuerte'"
                autocomplete="off"
                [class.ng-invalid]="submitted && f['password'].errors">
              </p-password>
            </p-inputgroup>
            @if (submitted && f['password'].errors) {
              <small class="p-error">
                {{ f['password'].errors['required'] ? 'Requerida' : 'Mínimo 6 caracteres' }}
              </small>
            }
          </div>
        </div>

        <div class="col-12 md:col-6">
          <div class="flex flex-column gap-2">
            <label for="confirmPassword" class="text-sm font-medium text-700">Confirmar</label>
            <p-inputgroup>
              <p-inputgroup-addon>
                <i class="pi pi-lock"></i>
              </p-inputgroup-addon>
              <p-password 
                id="confirmPassword"
                formControlName="confirmPassword"
                [feedback]="false"
                [toggleMask]="true"
                [style]="{'width': '100%'}"
                inputStyleClass="w-full"
                [class.ng-invalid]="submitted && (f['confirmPassword'].errors || registerForm.errors?.['passwordMismatch'])">
              </p-password>
            </p-inputgroup>
            @if (submitted && registerForm.errors?.['passwordMismatch']) {
              <small class="p-error">
                No coinciden
              </small>
            }
          </div>
        </div>
      </div>

      <!-- Fila 5: Rol y Términos -->
      <div class="grid align-items-center">
        <div class="col-12 md:col-6">
          <div class="flex align-items-center gap-4">
            <label class="text-sm font-medium text-700">Rol:</label>
            <div class="flex gap-3">
              <div class="flex align-items-center gap-2">
                <p-radioButton 
                  name="rol" 
                  value="usuario" 
                  formControlName="rol" 
                  inputId="rol_usuario">
                </p-radioButton>
                <label for="rol_usuario" class="text-sm text-600 cursor-pointer">Usuario</label>
              </div>
              <div class="flex align-items-center gap-2">
                <p-radioButton 
                  name="rol" 
                  value="admin" 
                  formControlName="rol" 
                  inputId="rol_admin">
                </p-radioButton>
                <label for="rol_admin" class="text-sm text-600 cursor-pointer">Admin</label>
              </div>
            </div>
          </div>
        </div>

        <div class="col-12 md:col-6">
          <div class="flex align-items-center gap-2">
            <p-checkbox 
              formControlName="acceptTerms" 
              [binary]="true" 
              inputId="acceptTerms">
            </p-checkbox>
            <label for="acceptTerms" class="text-sm text-600 cursor-pointer">
              Acepto <a class="text-primary font-medium no-underline" (click)="onTermsClick()">términos</a>
            </label>
          </div>
          @if (submitted && f['acceptTerms'].errors) {
            <small class="p-error block">
              Requerido
            </small>
          }
        </div>
      </div>

      <!-- Botones -->
      <p-button 
        type="submit" 
        label="Registrarse" 
        icon="pi pi-user-plus"
        [loading]="loading"
        styleClass="w-full p-3 text-lg font-medium"
        [raised]="true">
      </p-button>

      <div class="flex align-items-center gap-2 text-sm text-500">
        <span class="flex-1 border-top-1 border-300"></span>
        <span>¿Ya tienes cuenta?</span>
        <span class="flex-1 border-top-1 border-300"></span>
      </div>

      <p-button 
        type="button" 
        label="Iniciar sesión" 
        icon="pi pi-sign-in"
        styleClass="p-button-outlined w-full p-3 text-lg font-medium"
        routerLink="/auth/login">
      </p-button>
    </form>

    <div class="text-center mt-4 text-sm text-500">
      © 2026 Sistema de Becas
    </div>
  </div>
</div>